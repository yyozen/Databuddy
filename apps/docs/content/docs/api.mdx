---
title: API Reference
description: Complete API reference for Databuddy analytics endpoints
---

Access your analytics data programmatically with Databuddy's REST API. All endpoints require authentication and are rate-limited for security.

import { Callout } from "@/components/docs";
import { CodeBlock } from "@/components/docs";

<Callout type="info">
  **Try it live!** Test all these endpoints interactively in our [API
  Playground](/api) with real data and see instant responses. Perfect for
  exploring query types and understanding the API structure.
</Callout>

## Authentication

All API requests require authentication using either session cookies (for browser-based requests) or API keys (for programmatic access). The API supports both authentication methods seamlessly.

Use your API key in the `x-api-key` header:

<CodeBlock 
  language="bash"
  code={`curl -H "x-api-key: dbdy_your_api_key_here" \\
  https://api.databuddy.cc/v1/query/websites`}
/>

**Required Scope:**
- `read:data` - Required for all query endpoints

**API Key Access Levels:**
- **Global Access**: Access all websites in your account/organization
- **Website-Specific Access**: Access only specified websites

## Base URLs

- **Analytics API**: `https://api.databuddy.cc/v1`
- **Event Tracking (Basket)**: `https://basket.databuddy.cc`

## Analytics Query API

### Get Accessible Websites

Get all websites you have access to through your authentication method.

<CodeBlock 
  language="http"
  code="GET /v1/query/websites"
/>

**Authentication:** Requires session cookie or API key with appropriate access.

**Response:**

<CodeBlock 
  language="json"
  code={`{
    "success": true,
    "websites": [
      {
        "id": "web_123",
        "name": "My Website",
        "domain": "example.com",
        "isPublic": false,
        "createdAt": "2024-01-01T00:00:00.000Z"
      }
    ],
    "total": 1
  }`}
/>

### Get Available Query Types

Get all available query types and their configurations.

<CodeBlock 
  language="http"
  code="GET /v1/query/types"
/>

**Parameters:**
- `include_meta` (optional, boolean) - Include detailed metadata about query types including descriptions, output fields, and visualization hints

**Response:**

<CodeBlock 
  language="json"
  code={`{
    "success": true,
    "types": ["summary", "pages", "traffic", "browser_name", "os_name", "device_types", "countries", "cities", "errors", "performance", "sessions", "custom_events", "profiles", "outbound_links", "outbound_domains", "engagement", "link_total_clicks", "link_clicks_by_day", "link_top_referrers", "link_top_countries", "link_top_devices", "link_top_browsers"],
    "configs": {
      "summary": {
        "allowedFilters": ["country", "device_type", "browser_name"],
        "customizable": true,
        "defaultLimit": 100
      }
    }
  }`}
/>

Use `include_meta=true` to get detailed metadata including descriptions, output fields, and visualization hints for each query type.

### Execute Dynamic Analytics Query

Execute analytics queries with advanced parameter support, including batch processing and flexible date ranges.

<CodeBlock 
  language="http"
  code="POST /v1/query"
/>

**Query Parameters:**
- `website_id` (required for website analytics) - The website ID to query
- `link_id` (required for link shortener analytics) - The link ID to query
- `schedule_id` (required for uptime monitor analytics) - The uptime schedule ID to query
- `timezone` (optional) - Timezone for date calculations (defaults to UTC)

Use one of `website_id`, `link_id`, or `schedule_id` depending on what you're querying.

**Request Body:**

<CodeBlock 
  language="json"
  code={`{
    "id": "my-query-123",
    "parameters": ["summary", "pages", "browser_name"],
    "startDate": "2024-01-01",
    "endDate": "2024-01-31",
    "limit": 100,
    "page": 1,
    "filters": [
      {
        "field": "country",
        "op": "in",
        "value": ["US", "CA"]
      }
    ],
    "granularity": "daily"
  }`}
/>

**Request Body Fields:**
- `parameters` (required) - Array of query type names or parameter objects
- `startDate` (required) - Start date in ISO 8601 format
- `endDate` (required) - End date in ISO 8601 format
- `id` (optional) - Query identifier returned in response
- `limit` (optional) - Max results per parameter (default: 100)
- `page` (optional) - Page number for pagination (default: 1)
- `filters` (optional) - Array of filter objects
- `granularity` (optional) - `"hourly"` or `"daily"` (default: daily)
- `groupBy` (optional) - Field(s) to group results by

Parameters can also be objects with their own date ranges:

<CodeBlock 
  language="json"
  code={`{
    "parameters": [
      "summary",
      {
        "name": "pages",
        "start_date": "2024-01-01",
        "end_date": "2024-01-15",
        "id": "pages-first-half"
      }
    ],
    "startDate": "2024-01-01",
    "endDate": "2024-01-31"
  }`}
/>

**Batch Query Request:**

Send an array of query objects to execute multiple queries in a single request:

<CodeBlock 
  language="json"
  code={`[
    {
      "id": "query-1",
      "parameters": ["summary", "pages"],
      "startDate": "2024-01-01",
      "endDate": "2024-01-31",
      "limit": 100
    },
    {
      "id": "query-2", 
      "parameters": ["browser_name", "os_name"],
      "startDate": "2024-01-01",
      "endDate": "2024-01-31",
      "limit": 50
    }
  ]`}
/>

**Available Query Types (Website Analytics - requires `website_id`):**
- `summary` - Overall website metrics and KPIs
- `pages` - Page views and performance data
- `traffic` - Traffic sources and referrers  
- `browser_name` - Browser usage analytics
- `os_name` - Operating system analytics
- `device_types` - Device category breakdown
- `countries` - Geographic visitor data by country
- `cities` - Geographic visitor data by city
- `errors` - JavaScript errors and issues
- `performance` - Web vitals and performance metrics
- `sessions` - Session-based analytics
- `custom_events` - Custom event tracking data
- `profiles` - User profile analytics
- `outbound_links` - Outgoing link clicks with destination URLs, link text, and click counts
- `outbound_domains` - Outgoing link clicks aggregated by destination domain
- `engagement` - User engagement metrics

**Available Query Types (Link Shortener Analytics - requires `link_id`):**
- `link_total_clicks` - Total clicks for a shortened link
- `link_clicks_by_day` - Daily breakdown of clicks
- `link_referrers_by_day` - Daily count of unique referrers
- `link_countries_by_day` - Daily count of unique countries
- `link_top_referrers` - Top referrers for the link
- `link_top_countries` - Top countries for the link
- `link_top_regions` - Top regions for the link
- `link_top_cities` - Top cities for the link
- `link_top_devices` - Device type breakdown (mobile, desktop, tablet)
- `link_top_browsers` - Browser breakdown for the link

**Filter Operations:**
- `eq` - Equals
- `ne` - Not equals
- `contains` - Contains substring (case-insensitive)
- `not_contains` - Does not contain substring
- `starts_with` - Starts with prefix
- `in` - Value is in array
- `not_in` - Value is not in array

**Single Query Response:**

<CodeBlock 
  language="json"
  code={`{
    "success": true,
    "queryId": "my-query-123",
    "data": [
      {
        "parameter": "summary",
        "success": true,
        "data": [
          {
            "date": "2024-01-01",
            "pageviews": 1250,
            "visitors": 890,
            "sessions": 1100
          }
        ]
      },
      {
        "parameter": "pages",
        "success": true,
        "data": [
          {
            "path": "/",
            "pageviews": 450,
            "visitors": 320
          }
        ]
      }
    ],
    "meta": {
      "parameters": ["summary", "pages"],
      "total_parameters": 2,
      "page": 1,
      "limit": 100,
      "filters_applied": 2
    }
  }`}
/>

**Batch Query Response:**

<CodeBlock 
  language="json"
  code={`{
    "success": true,
    "batch": true,
    "results": [
      {
        "queryId": "query-1",
        "data": [
          {
            "parameter": "summary",
            "success": true,
            "data": [...]
          }
        ],
        "meta": {
          "parameters": ["summary", "pages"],
          "total_parameters": 2,
          "page": 1,
          "limit": 100,
          "filters_applied": 0
        }
      }
    ]
  }`}
/>

## Event Tracking

### Send Custom Events

Track custom events programmatically using the basket endpoint.

<CodeBlock 
  language="http"
  code="POST basket.databuddy.cc/?client_id={website_id}"
/>

**Single Custom Event Request:**

<CodeBlock 
  language="json"
  code={`{
    "type": "custom",
    "name": "purchase",
    "anonymousId": "anon_user_123",
    "sessionId": "session_456",
    "timestamp": 1704067200000,
    "properties": {
      "value": 99.99,
      "currency": "USD",
      "product_id": "prod_123"
    }
  }`}
/>

**Minimal Custom Event (without session/user tracking):**

<CodeBlock 
  language="json"
  code={`{
    "type": "custom",
    "name": "newsletter_signup",
    "properties": {
      "source": "footer_form"
    }
  }`}
/>

**Batch Custom Events Request:**

<CodeBlock 
  language="http"
  code="POST basket.databuddy.cc/batch?client_id={website_id}"
/>

<CodeBlock 
  language="json"
  code={`[
    {
      "type": "custom",
      "name": "purchase",
      "anonymousId": "anon_user_123",
      "sessionId": "session_456",
      "timestamp": 1704067200000,
      "properties": {
        "value": 99.99,
        "currency": "USD",
        "product_id": "prod_123"
      }
    },
    {
      "type": "custom",
      "name": "signup",
      "anonymousId": "anon_user_124",
      "sessionId": "session_457",
      "timestamp": 1704067260000,
      "properties": {
        "plan": "premium",
        "source": "landing_page"
      }
    }
  ]`}
/>

**Required Fields:**
- `type`: Must be "custom"
- `name`: Event name (1-128 characters)

**Optional Fields:**
- `anonymousId`: Anonymous user identifier (max 128 characters) - not needed for all use cases
- `sessionId`: Session identifier (max 128 characters) - not needed for all use cases
- `timestamp`: Unix timestamp in milliseconds (defaults to current time)
- `properties`: JSON object with custom event properties

**Response:**

<CodeBlock 
  language="json"
  code={`{
    "status": "success",
    "type": "custom"
  }`}
/>

**Batch Response:**

<CodeBlock 
  language="json"
  code={`{
    "status": "success",
    "batch": true,
    "processed": 2,
    "results": [
      {
        "status": "success",
        "type": "custom",
        "eventId": "evt_12345"
      },
      {
        "status": "success", 
        "type": "custom",
        "eventId": "evt_12346"
      }
    ]
  }`}
/>

## Health Check

### API Health Status

Check the health status of the API and its dependencies.

<CodeBlock 
  language="http"
  code="GET /health"
/>

**Response:**

<CodeBlock 
  language="json"
  code={`{
    "clickhouse": true,
    "database": true,
    "redis": true,
    "success": true,
    "version": "1.0.0",
    "timestamp": "2024-01-01T12:00:00.000Z"
  }`}
/>

## Rate Limits

API endpoints have different rate limits based on their computational cost and your subscription plan:

### Plan-Based Rate Limits

Rate limits vary by your subscription tier:

- **Free**: 50 requests per 10 seconds (300/minute)
- **Hobby**: 100 requests per 10 seconds (600/minute)  
- **Pro**: 200 requests per 10 seconds (1,200/minute)
- **Scale**: 500 requests per 10 seconds (3,000/minute)

### Endpoint-Specific Rate Limits

Certain endpoints have additional restrictions:

- **Public endpoints**: 100 requests per minute
- **Authentication endpoints**: 30 requests per minute
- **Custom SQL**: 30 requests per minute (heavy operations)

Rate limit headers are included in responses:

<CodeBlock 
  language="http"
  code={`X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1640995200`}
/>

## Error Handling

All errors follow a consistent format:

<CodeBlock 
  language="json"
  code={`{
    "success": false,
    "error": "Website not found or access denied",
    "code": "WEBSITE_NOT_FOUND"
  }`}
/>

**Common Error Codes:**

- `AUTH_REQUIRED` - Authentication required (missing API key or session)
- `ACCESS_DENIED` - Authenticated but no access to the requested resource
- `MISSING_PROJECT_ID` - Missing `website_id`, `link_id`, or `schedule_id` parameter
- `VALIDATION_ERROR` - Request validation failed
- `RATE_LIMIT_EXCEEDED` - Too many requests
- `INTERNAL_SERVER_ERROR` - Server error occurred

## Practical Examples

### Getting Started Workflow

1. **Get your accessible websites:**

<CodeBlock 
  language="bash"
  code={`curl -H "x-api-key: dbdy_your_api_key_here" \\
  https://api.databuddy.cc/v1/query/websites`}
/>

2. **Explore available query types:**

<CodeBlock 
  language="bash"
  code={`curl -H "x-api-key: dbdy_your_api_key_here" \\
  "https://api.databuddy.cc/v1/query/types?include_meta=true"`}
/>

3. **Execute a simple query:**

<CodeBlock 
  language="bash"
  code={`curl -X POST -H "x-api-key: dbdy_your_api_key_here" \\
  -H "Content-Type: application/json" \\
  -d '{
    "parameters": ["summary", "pages", "browser_name"],
    "startDate": "2024-01-01",
    "endDate": "2024-01-31",
    "limit": 10
  }' \\
  "https://api.databuddy.cc/v1/query?website_id=web_123"`}
/>

### Link Shortener Analytics

Query analytics for a specific shortened link using `link_id` instead of `website_id`:

<CodeBlock 
  language="bash"
  code={`curl -X POST -H "x-api-key: dbdy_your_api_key_here" \\
  -H "Content-Type: application/json" \\
  -d '{
    "parameters": ["link_total_clicks", "link_clicks_by_day", "link_top_referrers"],
    "startDate": "2024-01-01",
    "endDate": "2024-01-31",
    "limit": 10
  }' \\
  "https://api.databuddy.cc/v1/query?link_id=link_abc123"`}
/>

**Link Analytics Response:**

<CodeBlock 
  language="json"
  code={`{
    "success": true,
    "queryId": "",
    "data": [
      {
        "parameter": "link_total_clicks",
        "success": true,
        "data": [
          {
            "total": 1542
          }
        ]
      },
      {
        "parameter": "link_clicks_by_day",
        "success": true,
        "data": [
          {
            "date": "2024-01-01",
            "clicks": 125
          },
          {
            "date": "2024-01-02",
            "clicks": 143
          }
        ]
      },
      {
        "parameter": "link_top_referrers",
        "success": true,
        "data": [
          {
            "name": "twitter.com",
            "referrer": "twitter.com",
            "clicks": 523
          },
          {
            "name": "Direct",
            "referrer": "Direct",
            "clicks": 412
          }
        ]
      }
    ],
    "meta": {
      "parameters": ["link_total_clicks", "link_clicks_by_day", "link_top_referrers"],
      "total_parameters": 3,
      "page": 1,
      "limit": 10,
      "filters_applied": 0
    }
  }`}
/>

### Outbound Links Analytics

Track which external links users click on your website:

<CodeBlock 
  language="bash"
  code={`curl -X POST -H "x-api-key: dbdy_your_api_key_here" \\
  -H "Content-Type: application/json" \\
  -d '{
    "parameters": ["outbound_links", "outbound_domains"],
    "startDate": "2024-01-01",
    "endDate": "2024-01-31",
    "limit": 20
  }' \\
  "https://api.databuddy.cc/v1/query?website_id=web_123"`}
/>

**Outbound Links Response:**

<CodeBlock 
  language="json"
  code={`{
    "success": true,
    "queryId": "",
    "data": [
      {
        "parameter": "outbound_links",
        "success": true,
        "data": [
          {
            "href": "https://github.com/example/repo",
            "text": "View on GitHub",
            "total_clicks": 245,
            "unique_users": 189,
            "unique_sessions": 210,
            "percentage": 15.2,
            "last_clicked": "2024-01-31T15:42:00.000Z"
          }
        ]
      },
      {
        "parameter": "outbound_domains",
        "success": true,
        "data": [
          {
            "domain": "github.com",
            "total_clicks": 523,
            "unique_users": 412,
            "unique_links": 8,
            "percentage": 32.5
          }
        ]
      }
    ],
    "meta": {
      "parameters": ["outbound_links", "outbound_domains"],
      "total_parameters": 2,
      "page": 1,
      "limit": 20,
      "filters_applied": 0
    }
  }`}
/>